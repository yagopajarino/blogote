

<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<style>
@media (prefers-color-scheme: dark) {
    body {
        background-color: #1c1c1c;
        color: white;
    }
    .markdown-body table tr {
        background-color: #1c1c1c;
    }
    .markdown-body table tr:nth-child(2n) {
        background-color: black;
    }
}
</style>



<link rel="alternate" type="application/rss+xml" href="../../../../feed.xml" title="üöç Linea 152">



<link rel="stylesheet" type="text/css" href="../../../../css/common-vendor.b8ecfc406ac0b5f77a26.css">
<link rel="stylesheet" type="text/css" href="../../../../css/fretboard.f32f2a8d5293869f0195.css">
<link rel="stylesheet" type="text/css" href="../../../../css/pretty.0ae3265014f89d9850bf.css">
<link rel="stylesheet" type="text/css" href="../../../../css/pretty-vendor.83ac49e057c3eac4fce3.css">
<link rel="stylesheet" type="text/css" href="../../../../css/global.css">
<link rel="stylesheet" type="text/css" href="../../../../css/misc.css">

<script type="text/x-mathjax-config">
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\(', '\)']]
  },
  svg: {
    fontCache: 'global',
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async
  src="../../../../scripts/tex-svg.js">
</script>

<style>
</style>

<div id="doc" class="container-fluid markdown-body comment-enabled" data-hard-breaks="true">

<div id="color-mode-switch">
  <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
    <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
  </svg>
  <input type="checkbox" id="switch" />
  <label for="switch">Dark Mode Toggle</label>
  <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
    <path stroke-linecap="round" stroke-linejoin="round" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
  </svg>
</div>

<script type="text/javascript">
  // Update root html class to set CSS colors
  const toggleDarkMode = () => {
    const root = document.querySelector('html');
    root.classList.toggle('dark');
  }

  // Update local storage value for colorScheme
  const toggleColorScheme = () => {
    const colorScheme = localStorage.getItem('colorScheme');
    if (colorScheme === 'light') localStorage.setItem('colorScheme', 'dark');
    else localStorage.setItem('colorScheme', 'light');
  }

  // Set toggle input handler
  const toggle = document.querySelector('#color-mode-switch input[type="checkbox"]');
  if (toggle) toggle.onclick = () => {
    toggleDarkMode();
    toggleColorScheme();
  }

  // Check for color scheme on init
  const checkColorScheme = () => {
    const colorScheme = localStorage.getItem('colorScheme');
    // Default to light for first view
    if (colorScheme === null || colorScheme === undefined) localStorage.setItem('colorScheme', 'light');
    // If previously saved to dark, toggle switch and update colors
    if (colorScheme === 'dark') {
      toggle.checked = true;
      toggleDarkMode();
    }
  }
  checkColorScheme();
</script>

<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="üöç Linea 152" />
<meta name="twitter:image" content="https://cdn-icons-png.flaticon.com/512/10026/10026257.png" />


<br>
<h1 style="margin-bottom:7px"> üöç Linea 152 </h1>
<small style="float:left; color: #888"> 2023 Mar 23 </small>
<small style="float:right; color: #888"><a href="../../../../index.html">See all posts</a></small>
<br> <br> <br>
<title> üöç Linea 152 </title>

<p>Si alguna vez llegaste a conocer la <a
href="https://es.wikipedia.org/wiki/Avenida_Santa_Fe">Avenida Santa
Fe</a> de Buenos Aires, o su continuaci√≥n en Cabildo-Maip√∫, seguro te
cruzaste con uno (o muchos) colectivos de la l√≠nea 152 como los de la
foto.</p>
<p>Recorrido super simple: Olivos - La Boca todo derecho por Paseo Col√≥n
- Leandro N. Alem - Santa Fe - Cabildo - Maip√∫</p>
<p>Y seguramente tambi√©n habr√°s notado que es m√°s probable cruzarte tres
colectivos uno atr√°s del otro que encontrar uno solo. <strong>La
frecuencia es 10/10</strong>.</p>
<p><img src="../../../../images/152.png" /></p>
<h2 id="una-tarde-sin-bater√≠a">Una tarde sin bater√≠a</h2>
<p>Una tarde sin bater√≠a en el tel√©fono, volviendo de Vicente L√≥pez, me
tomo el 152 y como no ten√≠a el tel√©fono para scrollear alguna app, me
puse a <em>divagar</em> (super recomendable de vez en cuando) y en una
de esas encontr√© este cartel pegado en una pared del bondi:</p>
<p><img src="../../../../images/cronograma.png" /></p>
<p>Yo sab√≠a que la frecuencia era buen√≠sima y medio este cartel lo
confirmaba. Entre las 8 y las 19 sale un bondi cada tres minutos, una
locura ü§Ø</p>
<p>As√≠ que me pregunt√©,</p>
<blockquote>
<p>ü§î ¬øCu√°ntos bondis ser√°n necesarios para poder cubrir todo el
cronograma de frecuencias?</p>
</blockquote>
<p>Le saqu√© una foto al cartel y me llev√© la tarea de intentar responder
la pregunta.</p>
<h2 id="fabricando-la-respuesta">Fabricando la respuesta üîß</h2>
<p>Creo que esa misma noche empec√© a imaginar una respuesta a la
pregunta, o al menos, a hacer otras preguntas que me permitan responder
la original, como:</p>
<ol type="1">
<li>¬øD√≥nde est√°n las cabeceras del recorrido?</li>
<li>¬øCu√°nto tarda un colectivo en hacer el recorrido entre
cabeceras?</li>
<li>¬øC√≥mo influye el tr√°fico en la duraci√≥n del recorrido?</li>
</ol>
<p>Tambi√©n me puse a pensar que bien pudo haber sido la misma pregunta
que el/los due√±os de la empresa se tuvieron que hacer luego de definir
el cronograma de frecuencias y por lo tanto, determinar la cantidad
<strong>m√≠nima</strong> de colectivos que pudieran cumplir con el
cronograma era lo mejor para el negocio.</p>
<p>Entonces no es solo encotrar una respuesta que sea v√°lida, sino que
hay una idea de <em>optimizaci√≥n</em>, buscar la m√≠nima cantidad de
colectivos que cumplen lo pedido.</p>
<h3 id="respuesta-1-naive">Respuesta 1: naive</h3>
<p>La primer respuesta, la llamo <em>naive</em> (ingenua) es tener un
colectivo para cada horario de salida, de esa forma me aseguro tener un
colectivo disponible para cada salida en el cronograma.</p>
<p>Luego, contando la cantidad de salidas del cronograma, se
necesitar√≠an 302 colectivos de ida y 302 colectivos de vuelta, 604
colectivos en total.</p>
<p>Le pregunt√© a chat GPT cuanto espacio ocupan 604 colectivos, pensando
en que en alg√∫n lugar se tendr√≠an que estacionar:</p>
<p><img src="../../../../images/chat.png" /></p>
<p>Se necesitar√≠an m√°s de tres canchas de futbol para estacionar 604
colectivos, un mont√≥n. Inviable desde el espacio, adem√°s parece l√≥gico
pensar que los colectivos se pueden reutilizar.</p>
<h3 id="respuesta-2-reutilizando-colectivos">Respuesta 2: reutilizando
colectivos</h3>
<p>Esta es la idea m√°s l√≥gica, tengo un colectivo que hace el recorrido
de punta a punta y cuando llega al final arranca en sentido
contrario.</p>
<p>Ahora s√≠, para poder usar esta estrategia hay que conocer cu√°nto se
tarda en hacer el recorrido de punta a punta.</p>
<h4 id="cronometrando-el-recorrido">Cronometrando el recorrido</h4>
<p>Para poder saber cu√°nto tarda un colectivo en hacer el recorrido,
bien podr√≠a haberme tomado uno (o varios) colectivos desde la terminal y
cronometrar cu√°nto tarda en llegar al final del recorrido.</p>
<p>Es muy f√°cil ver que es un m√©todo bastante ineficiente, debe haber
algo mejor.</p>
<p>Hace un tiempo, por otro tema, encontre las <a
href="https://buenosaires.gob.ar/desarrollourbano/transporte/apitransporte">API
publicas del GCBA</a> que en particular permiten <strong>ver la posici√≥n
en tiempo real</strong> de los colectivos circulando por la
capital/GBA.</p>
<blockquote>
<p>üí° Si tengo la posici√≥n geogr√°fica de los colectivos, puedo calcular
cuanto tardan en relizar el recorrido de punta a punta.</p>
</blockquote>
<p>La API toma una l√≠nea de colectivos y devuelve la posici√≥n gps
(latitud, longitud) de todos los colectivos de esa l√≠nea en tiempo
real.</p>
<p><img src="../../../../images/mapa.png" /></p>
<p>Mapa de colectivos l√≠nea 152 del 23/01/2023 a las 20:15hs</p>
<p>En el mapa se ven los colectivos:</p>
<ul>
<li>Rojo hacia Olivos</li>
<li>Azul hacia La Boca</li>
<li>Verde en terminal</li>
</ul>
<h4 id="bot-the-data">Bot the data ü§ñ</h4>
<p>Esa noche (23/01/2023) me qued√© programando un bot que hiciera lo
siguiente:</p>
<ol type="1">
<li>Llame a la API del GCBA</li>
<li>Tome la respuesta y extraiga las posiciones de los colectivos</li>
<li>Guarde las posiciones en un csv</li>
</ol>
<p>El bot qued√≥ corriendo el 24/01/2023 entre las 8 y las 10 y entre las
15 y las 20 horas cada 30 segundos.</p>
<h4 id="gimme-the-data">Gimme the data</h4>
<p>Una vez obtenida toda la informaci√≥n, en bruto, quedaba analizarla y
sacar conclusiones, hab√≠a que responder la pregunta: <strong>¬øCu√°nto
tarda un colectivo en realizar el recorrido de punta a
punta?</strong></p>
<p>Empiezo a analizar los datos y me encuentro lo siguiente:</p>
<p><img src="../../../../images/hist.png" /></p>
<p>Ok como esperaba, tengo datos entre las 8 y las 9 y pico; y luego
entre las 15 y las 20 horas.</p>
<p><img src="../../../../images/dist.png" /></p>
<p>Este gr√°fico era m√°s interesante, me mostraba la distancia en desvios
est√°ndar a la media de duraci√≥n del recorrido para cada viaje, seg√∫n el
horario de salida (start_datetime).</p>
<p>Permit√≠a identificar dos grupos de datos bien claros, los viajes de
la ma√±ana con duraci√≥n bastante menor a la media y los de la tarde con
duraci√≥n por encima de la media. Es decir, los colectivos de la ma√±ana
tardaban menos, influenciado seguramente por el tr√°nsito.</p>
<h4 id="clusterizando-horarios">Clusterizando horarios</h4>
<p>Para no complicarme mucho, divid√≠ el horario del recorrido en 3
intervalos:</p>
<ol type="1">
<li>poco tr√°fico: entre las 22 y las 10</li>
<li>medio tr√°fico: entre las 10 y las 16</li>
<li>mucho tr√°fico: entre las 16 y las 22</li>
</ol>
<p>Luego para el 1er y 3er intervalo pod√≠a usar los datos reales,
calcular la media de cada grupo.</p>
<p>Quedaba conseguir la duraci√≥n media para la franja entre las 10 y las
16. Para calcularlo arm√© un regresor lineal simple con los datos,
obteniendo:</p>
<p><img src="../../../../images/trafico.png" /></p>
<p>En rojo: regresi√≥n lineal simple aplicada a los datos. La recta roja
es la que mejor se ajusta a los datos.</p>
<p>Y usando el resultado llegue a determinar el tiempo medio de la 2da
franja</p>
<p>As√≠, los datos de duraci√≥n media del recorrido quedaron:</p>
<ol type="1">
<li>22hs - 10hs: 1.64hs</li>
<li>10hs - 16hs: 4.02hs</li>
<li>16hs-22hs: 4.57hs</li>
</ol>
<h4 id="calculando-colectivos">Calculando colectivos</h4>
<p>Ahora quedaba lo m√°s f√°cil, sabiendo los horarios de partida y la
duraci√≥n del recorrido para cada horario, contar la cantidad de
colectivos necesarios.</p>
<p>Lo simul√© en python:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulaci√≥n de un d√≠a de l√≠nea 152</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>minuto <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>necesarios <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>en_terminal <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>en_recorrido <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>salidas <span class="op">=</span> get_salidas()</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> minuto <span class="op">&lt;</span> <span class="dv">1440</span>:</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> hay_llegada(minuto, en_recorrido):</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>        en_recorrido.remove(minuto)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>        en_terminal <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> hay_salida(minuto, salidas):</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> en_terminal <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>            necesarios <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>            en_terminal <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        agregar_llegada(en_recorrido, tiempo_llegada(minuto))</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        en_terminal <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    minuto <span class="op">+=</span> <span class="dv">1</span></span></code></pre></div>
<p>Luego, <strong>hacen falta 81 colectivos, por recorrido, para cumplir
con el cronograma de salidas del 152.</strong></p>
<h3 id="conclusiones">Conclusiones</h3>
<p>Con la segunda estrategia, se logra bajar la cantidad de colectivos
de 604 a 162, bastante mejor :)</p>
 </div> 